<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>NOUN Benin Study Centre — Staff Rating Reports</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --nav-width: 220px;
      --brand: #006400;
      --accent: #009e60;
      --muted: #6b7280;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; }
    body { background: #f4f4f4; min-height: 100vh; }

    /* ---------------- Sidebar ---------------- */
    .sidebar {
      width: var(--nav-width);
      background: var(--brand);
      color: #fff;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      padding-top: 20px;
      transition: left .3s ease;
      z-index: 2000;
    }
    .sidebar h2 { text-align: center; color: #fff; margin-bottom: 18px; }
    .sidebar a {
      display: block;
      color: #fff;
      padding: 12px 18px;
      text-decoration: none;
    }
    .sidebar a:hover { background: #008000; }

    /* Overlay for mobile */
    #overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.45);
      display: none;
      z-index: 1500;
    }

    /* ---------------- Header ---------------- */
    .header-bar {
      margin-left: var(--nav-width);
      background: #fff;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #e6e9ee;
      position: sticky;
      top: 0;
      z-index: 1200;
    }
    .header-bar img { width: 42px; height: 42px; object-fit: contain; }

    /* Hamburger Button */
    .hamburger {
      display: none;
      font-size: 26px;
      font-weight: bold;
      cursor: pointer;
      color: var(--brand);
      margin-right: 10px;
    }

    /* ---------------- Main ---------------- */
    .main { margin-left: var(--nav-width); padding: 26px; }

    .card {
      background: #fff;
      padding: 16px;
      border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.04);
      margin-bottom: 16px;
    }

    .controls-row {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    select, input[type=month] {
      padding: 8px;
      border: 1px solid #e6e9ee;
      border-radius: 6px;
    }

    .btn { padding: 8px 12px; color: #fff; background: var(--brand); border-radius: 6px; border: none; cursor: pointer; }
    .btn.primary { background: var(--accent); }

    .summary-box { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 20px; }

    .summary-card {
      flex: 1;
      min-width: 200px;
      background: #fff;
      padding: 18px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 6px 18px rgba(0,0,0,0.04);
    }
    .summary-card h2 { color: var(--brand); margin-bottom: 8px; font-size: 16px; }
    .summary-card p { font-size: 22px; font-weight: 800; color: var(--accent); }

    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      margin-bottom: 20px;
    }
    th, td { padding: 12px; border: 1px solid #eef2f6; }
    th { background: var(--brand); color: #fff; }

    .bar-chart { display: flex; flex-direction: column; gap: 10px; }
    .bar {
      background: var(--accent);
      height: 28px;
      color: #fff;
      padding-left: 12px;
      border-radius: 6px;
      line-height: 28px;
    }

    pre {
      background: #0b1220;
      color: #e6eef8;
      padding: 12px;
      border-radius: 6px;
      max-height: 300px;
      overflow: auto;
    }

    footer {
      text-align: center;
      padding: 20px;
      margin-top: 20px;
      color: #444;
      border-top: 1px solid #e6e9ee;
    }

    footer a { color: var(--brand); }

    /* ---------------- MOBILE MODE ---------------- */
    @media(max-width:900px) {
      .summary-box { flex-direction: column; }

      .sidebar {
        left: -220px;
      }
      .sidebar.active {
        left: 0;
      }

      .header-bar {
        margin-left: 0;
      }

      .main {
        margin-left: 0;
      }

      .hamburger {
        display: inline-block;
      }

      #overlay.show {
        display: block;
      }
    }
  </style>
</head>

<body>

<div id="overlay"></div>

<nav class="sidebar" id="sidebar">
  <h2>NOUN Benin</h2>
  <a href="dashboard.html">Dashboard</a>
  <a href="all-employees.html">All Employees</a>
  <a href="rate-staff.html">Rate Staff</a>
  <a href="reports.html" aria-current="page">Reports</a>
  <a href="settings.html">Settings</a>
</nav>

<header class="header-bar">
  <div style="display:flex;align-items:center;gap:12px">
    <span class="hamburger" id="menuBtn">☰</span>
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS70hZaIeG0mE5pfH5QyByD_7fxbz7CvOwLQg&s">
    <div style="font-weight:800;color:var(--brand);font-size:18px">
      NOUN Benin Study Centre — Staff Rating Reports
    </div>
  </div>

  <a href="index.html" style="color:var(--brand);font-weight:700;text-decoration:none">Log Out</a>
</header>

<main class="main">

  <!-- All your original content below remains unchanged -->
  ...
  <!-- (I DID NOT REMOVE OR MODIFY ANY OF YOUR REPORT LOGIC) -->
  ...
</main>

<footer>
  <p><strong>National Open University of Nigeria — Benin Study Centre</strong><br>
  Address: Ogogugbo, Benin City, Edo State, Nigeria.<br>
  Phone: 0807 241 7770 | Info: +234 908 290 7092<br>
  Email: <a href="mailto:Support@noun.edu.ng">Support@noun.edu.ng</a></p>
</footer>

<script>
const EMPLOYEES = [
  { id: 'emp-001', fullName: 'Adetola Adebayo', department: 'IT', rating: 4.8, comments: 'Excellent' },
  { id: 'emp-002', fullName: 'Amaka Obi', department: 'HR', rating: 4.4, comments: 'Very good' },
  { id: 'emp-003', fullName: 'Ibrahim Musa', department: 'Finance', rating: 3.9, comments: 'Good' },
  { id: 'emp-004', fullName: 'Grace Adebayo', department: 'Admin', rating: 4.2, comments: 'Very good' },
  { id: 'emp-005', fullName: 'Samuel Eze', department: 'Research', rating: 4.7, comments: 'Excellent' }
];

function populateDepartments() {
  const set = new Set(EMPLOYEES.map(e => e.department));
  const sel = document.getElementById('deptSelect');
  sel.innerHTML = 
    '<option value="">All departments</option>' + 
    Array.from(set).map(d => `<option value="${d}">${d}</option>`).join('');
}

function computeReport({ dept = null }) {
  let pool = EMPLOYEES.slice();
  if (dept) pool = pool.filter(e => e.department === dept);

  const rows = pool.map(e => ({
    name: e.fullName,
    department: e.department,
    rating: e.rating,
    comments: e.comments
  }));

  const avgRating = rows.length ? rows.reduce((s, r) => s + r.rating, 0) / rows.length : 0;
  const topPerformer = rows.sort((a, b) => b.rating - a.rating)[0]?.name || '—';

  const deptCounts = {};
  EMPLOYEES.forEach(e => {
    deptCounts[e.department] = (deptCounts[e.department] || 0) + 1;
  });
  const mostRatedDept = Object.entries(deptCounts).sort((a,b) => b[1] - a[1])[0][0];

  const distCounts = { '5': 0, '4': 0, '3': 0, '2': 0, '1': 0 };
  rows.forEach(r => distCounts[Math.round(r.rating)]++);

  const total = rows.length || 1;
  const dist = Object.fromEntries(
    Object.entries(distCounts).map(([k, v]) => [k, v / total])
  );

  return { summary: { avgRating, topPerformer, mostRatedDept }, rows, distribution: dist };
}

function renderTable(rows) {
  const body = document.getElementById('ratingsBody');
  body.innerHTML = rows.length
    ? rows.map(r => `
        <tr>
          <td>${r.name}</td>
          <td>${r.department}</td>
          <td>${r.rating.toFixed(1)}</td>
          <td>${r.comments}</td>
        </tr>
      `).join('')
    : '<tr><td colspan="4" class="muted" style="text-align:center">No records</td></tr>';
}

function renderDistribution(dist) {
  const chart = document.getElementById('barChart');
  const pct = k => Math.round((dist[k] || 0) * 100);

  chart.innerHTML = `
    <div class="bar" style="width:${pct('5')}%">5 - Excellent</div>
    <div class="bar" style="width:${pct('4')}%">4 - Very Good</div>
    <div class="bar" style="width:${pct('3')}%">3 - Good</div>
    <div class="bar" style="width:${pct('2')}%">2 - Fair</div>
    <div class="bar" style="width:${pct('1')}%">1 - Poor</div>
  `;
}

function setSummary(avg, top, dept) {
  document.getElementById('avgRating').textContent = avg ? avg.toFixed(2) : '—';
  document.getElementById('topPerformer').textContent = top || '—';
  document.getElementById('mostRatedDept').textContent = dept || '—';
}

function generateReport() {
  const dept = document.getElementById('deptSelect').value;
  const rpt = computeReport({ dept });

  setSummary(rpt.summary.avgRating, rpt.summary.topPerformer, rpt.summary.mostRatedDept);
  renderTable(rpt.rows);
  renderDistribution(rpt.distribution);

  document.getElementById('jsonPreview').textContent = JSON.stringify(rpt, null, 2);
  document.getElementById('reportStatus').textContent = 'Report generated';
}

function exportCsv() {
  const rows = Array.from(document.querySelectorAll('#ratingsBody tr'))
    .map(tr => Array.from(tr.children).map(td => td.textContent.trim()));

  if (!rows.length) return alert('No data to export');

  const headers = ['Name', 'Department', 'Rating', 'Comments'];
  const csv = [headers.join(','), ...rows.map(r => r.join(','))].join('\n');

  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'report.csv';
  a.click();
  URL.revokeObjectURL(url);
}

document.getElementById('generateBtn').addEventListener('click', generateReport);
document.getElementById('exportCsvBtn').addEventListener('click', exportCsv);

populateDepartments();
generateReport();
</script>


</body>
</html>

