<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>University Staff Rating Portal — Admin</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{--nav-width:220px;--brand:#003366;--accent:#cc0000;--muted:#6b7280}
    *{box-sizing:border-box;margin:0;padding:0;font-family:'Segoe UI',sans-serif}
    body{background:#f4f4f4;min-height:100vh}
    /* Sidebar */
    .sidebar{width:var(--nav-width);background:var(--brand);color:#fff;height:100vh;position:fixed;top:0;left:0;padding-top:20px}
    .sidebar h2{text-align:center;color:var(--accent);margin-bottom:18px;font-size:18px}
    .sidebar a{display:block;color:#fff;padding:12px 18px;text-decoration:none;font-weight:600}
    .sidebar a:hover{background:#0055aa}
    /* Header */
    .header-bar{margin-left:var(--nav-width);background:#fff;padding:12px 20px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e6e9ee;position:sticky;top:0;z-index:10}
    .header-left{display:flex;align-items:center;gap:12px}
    .header-left img{width:48px;height:48px;object-fit:contain}
    .header-left span{font-size:18px;font-weight:700;color:var(--brand)}
    .header-right a{color:var(--brand);text-decoration:none;font-weight:700}
    .top-menu{margin-left:var(--nav-width);background:var(--brand);padding:10px 20px;display:flex;gap:28px;justify-content:center}
    .top-menu a{color:#fff;text-decoration:none;font-weight:700}
    .top-menu a:hover{color:#ffcc00}
    /* Welcome banner */
    .welcome-banner{margin-left:var(--nav-width);margin-top:12px;height:200px;background-image:url('https://img.freepik.com/free-photo/students-studying-together-medium-shot_23-2148913227.jpg?semt=ais_hybrid&w=740&q=80');background-size:cover;background-position:center;display:flex;align-items:center;justify-content:center}
    .welcome-text{color:#fff;font-size:28px;font-weight:800;background:rgba(0,0,0,0.45);padding:12px 20px;border-radius:8px}
    /* Main */
    .main{margin-left:var(--nav-width);padding:26px}
    h1{color:var(--accent);margin-bottom:16px}
    .stats-grid{display:flex;gap:20px;margin-bottom:24px;flex-wrap:wrap}
    .stat-card{flex:1;min-width:200px;background:#fff;padding:18px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06);text-align:center}
    .stat-card h2{color:var(--brand);font-size:16px;margin-bottom:8px}
    .stat-card p{font-size:22px;font-weight:800;color:var(--accent);margin:0}
    /* Activity & profile */
    .grid-two{display:grid;grid-template-columns:1fr 420px;gap:20px}
    .card{background:#fff;padding:16px;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.04)}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #eef2f6;text-align:left;font-size:14px}
    th{background:#fbfdff;color:var(--brand);font-weight:700}
    .profile-container{max-width:800px;margin:0 auto}
    .value-box{border:1px solid #e6e9ee;padding:10px;border-radius:6px;background:#fafafa;color:#333}
    .btn{display:inline-block;padding:10px 14px;background:var(--accent);color:#fff;border-radius:6px;border:0;cursor:pointer;font-weight:700}
    .btn.secondary{background:#003366}
    footer{margin-left:var(--nav-width);padding:18px;text-align:center;color:#666;margin-top:28px}
    /* responsive */
    @media(max-width:920px){
      .grid-two{grid-template-columns:1fr}
      .welcome-banner{height:140px}
      .top-menu{flex-wrap:wrap;padding:12px}
    }
  </style>
</head>
<body>

  <nav class="sidebar" aria-label="Sidebar navigation">
    <h2>Admin Panel</h2>
    <a href="control-center.html">Dashboard</a>
    <a href="all-employees.html">All Employees</a>
    <a href="configure-criteria.html" id="cfgCriteriaLink">Configure Criteria</a>
    <a href="manage-users.html" id="manageUsersLink">Manage Users</a>
    <a href="rate-staff.html">Rate Staff</a>
    <a href="reports.html" id="reportsLink">Reports</a>
    <a href="settings.html">Settings</a>
  </nav>

  <header class="header-bar" role="banner">
    <div class="header-left">
      <img src="https://static.vecteezy.com/system/resources/thumbnails/006/470/455/small_2x/university-education-logo-design-template-vector.jpg" alt="University Logo" />
      <span>University Staff Rating Portal</span>
    </div>
    <div class="header-right">
      <a href="login.html" id="logoutBtn">Log Out</a>
    </div>
  </header>

  <div class="top-menu" role="navigation" aria-label="Top menu">
    <a href="about.html">About</a>
    <a href="events.html">Events/Activities</a>
    <a href="all-employees.html">All Employees</a>
    <a href="reports.html">View Reports</a>
  </div>

  <section class="welcome-banner" aria-hidden="false">
    <div class="welcome-text" id="welcomeText">Welcome, Admin</div>
  </section>

  <main class="main" role="main">
    <h1>Dashboard Overview</h1>

    <section class="stats-grid" aria-labelledby="summaryTitle">
      <div class="stat-card card">
        <h2>Total Employees</h2>
        <p id="totalStaff">...</p>
      </div>
      <div class="stat-card card">
        <h2>Average Rating</h2>
        <p id="avgRating">...</p>
      </div>
      <div class="stat-card card">
        <h2>Top Department</h2>
        <p id="topDept">...</p>
      </div>
    </section>

    <div class="grid-two">
      <section class="card">
        <h3>Recent Activities</h3>
        <table aria-describedby="recentActivities">
          <thead><tr><th>Time</th><th>User</th><th>Action</th></tr></thead>
          <tbody id="activityBody">
            <tr><td colspan="3" style="text-align:center;color:var(--muted)">Loading...</td></tr>
          </tbody>
        </table>
      </section>

      <aside class="card profile-container" aria-labelledby="adminProfile">
        <h3 id="adminProfile">Admin Profile</h3>
        <div style="margin-top:10px">
          <div class="field"><label style="font-weight:700">Admin Name:</label><div class="value-box" id="adminName">...</div></div>
          <div class="field"><label style="font-weight:700">Username:</label><div class="value-box" id="adminUser">...</div></div>
          <div class="field"><label style="font-weight:700">Email:</label><div class="value-box" id="adminEmail">...</div></div>
          <div class="field"><label style="font-weight:700">Phone Number:</label><div class="value-box" id="adminPhone">...</div></div>
          <div class="field"><label style="font-weight:700">Position:</label><div class="value-box" id="adminRole">...</div></div>
          <div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap">
            <button class="btn" id="editProfileBtn">Update</button>
            <button class="btn secondary" id="openReportsBtn">Open Reports</button>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <footer role="contentinfo">Copyright © NOUN Design by Barnabas Blessing</footer>

  <script>
    // Replace these endpoints with your real API paths
    const API = {
      summary: '/api/admin/summary',
      activities: '/api/admin/activities',
      profile: '/api/profile/me'
    };

    // Utility to set text safely
    function setText(id, txt){ const el = document.getElementById(id); if(el) el.textContent = txt ?? '—'; }

    async function fetchSummary(){
      try {
        const res = await fetch(API.summary, {credentials:'include'});
        if(!res.ok) throw new Error('Summary fetch failed');
        const d = await res.json();
        setText('totalStaff', d.totalStaff ?? '0');
        setText('avgRating', (d.averageRating ?? 0).toFixed(2));
        setText('topDept', d.topDepartment ?? '—');
        // personalize welcome
        const name = d.adminName || d.userName || 'Admin';
        document.getElementById('welcomeText').textContent = `Welcome, ${name}`;
      } catch (err) {
        // fallback demo values if API unreachable
        setText('totalStaff', '20');
        setText('avgRating', '4.2');
        setText('topDept', 'IT');
      }
    }

    async function fetchActivities(){
      try {
        const res = await fetch(API.activities, {credentials:'include'});
        if(!res.ok) throw new Error('Activities fetch failed');
        const list = await res.json();
        const body = document.getElementById('activityBody');
        if(!list.length) { body.innerHTML = '<tr><td colspan="3" style="text-align:center;color:var(--muted)">No recent activity</td></tr>'; return; }
        body.innerHTML = list.slice(0,8).map(a=>`<tr><td>${a.time}</td><td>${a.user}</td><td>${a.action}</td></tr>`).join('');
      } catch (err) {
        // demo fallback
        document.getElementById('activityBody').innerHTML = `
          <tr><td>2025-10-13 09:12</td><td>lucy eze</td><td>Created rating criteria</td></tr>
          <tr><td>2025-10-12 15:42</td><td>james.ad</td><td>Imported staff list</td></tr>
        `;
      }
    }

    async function fetchProfile(){
      try {
        const res = await fetch(API.profile, {credentials:'include'});
        if(!res.ok) throw new Error('Profile fetch failed');
        const p = await res.json();
        setText('adminName', p.fullName ?? 'Lucky Eze');
        setText('adminUser', p.username ?? 'admin');
        setText('adminEmail', p.email ?? 'lucyeze1234@edu.ng');
        setText('adminPhone', p.phone ?? '+234925634846');
        setText('adminRole', p.position ?? 'Level 3 Staff');
      } catch (err) {
        setText('adminName', 'Lucky Eze');
        setText('adminUser', 'Admin');
        setText('adminEmail', 'lucyeze1234@edu.ng');
        setText('adminPhone', '+234925634846');
        setText('adminRole', 'Level 3 Staff');
      }
    }

    // Wire navigation buttons (example behaviours)
    document.getElementById('openReportsBtn').addEventListener('click', () => { window.location.href = 'reports.html'; });
    document.getElementById('editProfileBtn').addEventListener('click', () => { window.location.href = 'edit-profile.html'; });

    // Logout behaviour (example)
    document.getElementById('logoutBtn').addEventListener('click', (e) => {
      // clear tokens here if stored, then redirect
      // sessionStorage.removeItem('srs_token'); localStorage.removeItem('srs_token');
      // for demo, allow normal link behaviour
    });

    // Initialize dashboard
    fetchSummary();
    fetchActivities();
    fetchProfile();
  </script>
</body>
</html>
